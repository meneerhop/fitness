
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dashboard - Moffel.fit</title>
<link rel="stylesheet" href="assets/layout.css">
</head>
<body>

<div class="container">
<h1>Dashboard</h1>

<h2>Schema</h2>
<input type="text" id="schemaInput" placeholder="Nieuwe oefening">
<button onclick="addSchema()">Toevoegen</button>
<ul id="schemaList"></ul>

<h2>Agenda</h2>
<input type="text" id="agendaInput" placeholder="Nieuwe afspraak">
<button onclick="addAgenda()">Toevoegen</button>
<ul id="agendaList"></ul>

<button onclick="logout()">Uitloggen</button>
</div>

<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

<script>

const firebaseConfig = {
  apiKey: "AIzaSyAa1DzEnexvARCeZixcN0JRTpheRY5WKZM",
  authDomain: "moffel-fit.firebaseapp.com",
  projectId: "moffel-fit",
  storageBucket: "moffel-fit.firebasestorage.app",
  messagingSenderId: "766711451730",
  appId: "1:766711451730:web:006be1b47507a9fc394f8b",
  measurementId: "G-ZR5XTCCJ62"
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.firestore();

auth.onAuthStateChanged(user=>{
  if(!user) return window.location="index.html";
  loadSchema(user.uid);
  loadAgenda(user.uid);
});

function addSchema(){
  const user = auth.currentUser;
  db.collection("users").doc(user.uid)
    .collection("schema").add({text:schemaInput.value})
    .then(()=>{
      schemaInput.value="";
      loadSchema(user.uid);
    });
}

function loadSchema(uid){
  schemaList.innerHTML="";
  db.collection("users").doc(uid)
    .collection("schema").get()
    .then(snapshot=>{
      snapshot.forEach(doc=>{
        const li=document.createElement("li");
        li.innerText=doc.data().text;
        schemaList.appendChild(li);
      });
    });
}

function addAgenda(){
  const user = auth.currentUser;
  db.collection("users").doc(user.uid)
    .collection("agenda").add({text:agendaInput.value})
    .then(()=>{
      agendaInput.value="";
      loadAgenda(user.uid);
    });
}

function loadAgenda(uid){
  agendaList.innerHTML="";
  db.collection("users").doc(uid)
    .collection("agenda").get()
    .then(snapshot=>{
      snapshot.forEach(doc=>{
        const li=document.createElement("li");
        li.innerText=doc.data().text;
        agendaList.appendChild(li);
      });
    });
}

function logout(){
  auth.signOut().then(()=>window.location="index.html");
}
</script>

</body>
</html>
